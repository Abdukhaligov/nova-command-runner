(function(e,h){typeof exports=="object"&&typeof module<"u"?h(require("vue")):typeof define=="function"&&define.amd?define(["vue"],h):(e=typeof globalThis<"u"?globalThis:e||self,h(e.Vue))})(this,function(e){"use strict";const h={key:0,class:"absolute inset-0 bg-gray-500/75 dark:bg-gray-900/75 rounded-lg"},f={__name:"Button",props:{theme:String,loading:Boolean},setup(n){return(d,a)=>{const c=e.resolveComponent("Loader");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["shadow relative h-10 px-4 rounded-lg bg-primary-500 text-white text-white flex items-center text-center cursor-pointer hover:opacity-75 transition",{"bg-red-500":n.theme==="danger","bg-yellow-500":n.theme==="warning","bg-blue-500":n.theme==="info","bg-green-500":n.theme==="success","bg-gray-200 !text-gray-900 dark:bg-gray-700 dark:!text-gray-300":n.theme==="gray","pointer-events-none":n.loading}])},[e.renderSlot(d.$slots,"default"),n.loading?(e.openBlock(),e.createElementBlock("div",h)):e.createCommentVNode("",!0),n.loading?(e.openBlock(),e.createBlock(c,{key:1,class:"absolute inset-0 m-auto text-white",width:"32"})):e.createCommentVNode("",!0)],2)}}},S=(n,d)=>{const a=n.__vccOpts||n;for(const[c,g]of d)a[c]=g;return a},D={props:{type:{type:String,required:!1},loading:{type:Boolean,default:!1},processing:{type:Boolean,default:!1}}},T={type:"button",class:"inline-flex relative items-center justify-center w-8 h-8 focus:outline-none focus:ring rounded-lg"},M={key:0,class:"absolute",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}};function L(n,d,a,c,g,w){const _=e.resolveComponent("Icon"),m=e.resolveComponent("Loader");return e.openBlock(),e.createElementBlock("button",T,[e.createElementVNode("span",{class:e.normalizeClass({invisible:a.processing||a.loading})},[e.renderSlot(n.$slots,"default"),a.type?(e.openBlock(),e.createBlock(_,{key:0,solid:"",type:a.type},null,8,["type"])):e.createCommentVNode("",!0)],2),a.processing||a.loading?(e.openBlock(),e.createElementBlock("span",M,[e.createVNode(m,{class:"text-gray-500",width:"32"})])):e.createCommentVNode("",!0)])}const u=S(D,[["render",L]]),j={class:"nova-command-runner"},O={class:"text-lg font-semibold mb-6"},$={key:0,class:"flex flex-col md:flex-row mb-3 md:space-x-3 space-y-2 md:space-y-0"},F=["value"],R={class:"bg-white dark:bg-gray-800 rounded-lg shadow mb-3 grid md:grid-cols-12 gap-6 p-6"},U={class:"text-sm font-semibold"},H={class:"flex flex-col md:flex-row md:items-center justify-between mt-6 mb-6"},q=e.createElementVNode("div",{class:"font-bold"},"History",-1),z={class:"md:ml-2 inline-flex items-center shadow rounded-lg bg-white dark:bg-gray-800 px-2 h-8"},I={class:"bg-white dark:bg-gray-800 rounded-lg shadow mb-3 p-2 overflow-y-hidden overflow-x-auto"},A={key:0,class:"w-full"},P=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-center px-2 whitespace-nowrap uppercase text-gray-500 text-xxs tracking-wide py-2"}," Command "),e.createElementVNode("th",{class:"text-center px-2 whitespace-nowrap uppercase text-gray-500 text-xxs tracking-wide py-2"}," Type "),e.createElementVNode("th",{class:"text-center px-2 whitespace-nowrap uppercase text-gray-500 text-xxs tracking-wide py-2"}," Run By "),e.createElementVNode("th",{class:"text-center px-2 whitespace-nowrap uppercase text-gray-500 text-xxs tracking-wide py-2"}," Status "),e.createElementVNode("th",{class:"text-center px-2 whitespace-nowrap uppercase text-gray-500 text-xxs tracking-wide py-2"}," Result "),e.createElementVNode("th",{class:"text-center px-2 whitespace-nowrap uppercase text-gray-500 text-xxs tracking-wide py-2"}," Duration "),e.createElementVNode("th",{class:"text-center px-2 whitespace-nowrap uppercase text-gray-500 text-xxs tracking-wide py-2"}," Happened ")])],-1),X={class:"px-2 py-2 border-t border-gray-100 dark:border-gray-700 whitespace-nowrap cursor-pointer dark:bg-gray-800 group-hover:bg-gray-50 dark:group-hover:bg-gray-900"},J={class:"px-2 py-2 border-t border-gray-100 dark:border-gray-700 whitespace-nowrap cursor-pointer dark:bg-gray-800 group-hover:bg-gray-50 dark:group-hover:bg-gray-900"},K={class:"px-2 py-2 border-t border-gray-100 dark:border-gray-700 whitespace-nowrap cursor-pointer dark:bg-gray-800 group-hover:bg-gray-50 dark:group-hover:bg-gray-900"},W={class:"px-2 py-2 border-t border-gray-100 dark:border-gray-700 whitespace-nowrap cursor-pointer dark:bg-gray-800 group-hover:bg-gray-50 dark:group-hover:bg-gray-900"},G=["innerHTML"],Q={class:"px-2 py-2 border-t border-gray-100 dark:border-gray-700 whitespace-nowrap cursor-pointer dark:bg-gray-800 group-hover:bg-gray-50 dark:group-hover:bg-gray-900"},Y={class:"px-2 py-2 border-t border-gray-100 dark:border-gray-700 whitespace-nowrap cursor-pointer dark:bg-gray-800 group-hover:bg-gray-50 dark:group-hover:bg-gray-900"},Z={key:1,class:"flex flex-col justify-center items-center px-6 py-8"},v=e.createElementVNode("h3",{class:"text-base font-normal mt-3"}," No Logs. ",-1),ee={key:1,class:"fixed inset-0 z-[60] bg-gray-500/75 dark:bg-gray-900/75 flex items-center justify-center p-3"},te={class:"relative p-6 bg-white dark:bg-gray-800 rounded-lg shadow min-w-80 md:w-1/2 max-w-full max-h-full overflow-y-auto"},re={class:"text-lg font-bold mb-5"},oe={class:"grid gap-6"},ae={key:0},ne={class:"mb-2 block leading-tight w-full text-sm font-semibold"},le=["onUpdate:modelValue"],se=["type","onUpdate:modelValue","placeholder"],ce={key:1},de=["onUpdate:modelValue"],ie={class:"flex items-center space-x-3 mt-5"},pe={__name:"Tool",setup(n){const d=e.ref(!1),a=e.ref(!1),c=e.ref(!1),g=e.ref(!1),w=e.ref(""),_=e.ref(),m=e.ref(),y=e.ref(),b=e.ref(),B=e.ref(),ge=e.ref(),C=e.ref(),x=e.ref(),k=e.ref(),o=e.ref();e.onMounted(async()=>{await N(),me()});async function N(){if(d.value)return;d.value=!0;const i=await fetch("/nova-vendor/stepanenko3/nova-command-runner");if(i.ok){const r=await i.clone().json();w.value=r.heading,m.value=r.history,B.value=r.commands,ge.value=r.help,C.value=r.polling_time,b.value=[],r.commands.forEach(p=>{let t=p.group;b.value.indexOf(t)<0&&b.value.push(t)}),y.value=r.custom_commands,y.value&&Object.keys(y.value).indexOf(k.value)===-1&&(k.value=Object.keys(y.value)[0])}d.value=!1}function me(){_.value=setInterval(()=>{!d.value&&(a.value||m.value.filter(i=>i.status==="pending").length>0)&&N()},C.value)}function ye(){E({label:"Clear Command Run History",type:"primary",help:"Are you sure you want to clear the command run history?",command_type:"artisan",command:"cache:forget nova-command-runner-history",variables:[],flags:[]})}function E(i){o.value=i,g.value=!0}function V(){g.value=!1,o.value={}}function he(){let i=!0;o.value.variables&&Object.keys(o.value.variables).forEach(r=>{(o.value.variables[r].value==null||o.value.variables[r].value.length===0)&&(i=!1,Nova.error(o.value.variables[r].label+" is required"))}),i&&(c.value=!0,fetch("/nova-vendor/stepanenko3/nova-command-runner/run",{method:"POST",headers:{"X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content,"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"},body:JSON.stringify({command:o.value})}).then(async r=>{if(r.ok){const p=await r.json();p.status&&(p.status==="success"||p.status==="pending")?Nova.success(p.result):Nova.error(p.result),c.value=!1,m.value=p.history,V()}else Nova.error(`${r.status}: ${r.statusText||"Something went wrong"}`),c.value=!1,V()}).catch(r=>{c.value=!1}))}function ke(){if(!x.value){Nova.error("Please enter a command");return}E({label:"Custom Command",type:"primary",help:"Are you sure you want to run this command?",command_type:k.value,command:x.value,variables:[],flags:[]})}return(i,r)=>{const p=e.resolveComponent("Icon");return e.openBlock(),e.createElementBlock("div",j,[e.createElementVNode("div",O,e.toDisplayString(w.value),1),Array.isArray(y.value)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",$,[e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":r[0]||(r[0]=t=>k.value=t),class:"appearance-none bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-800 h-10 px-3 rounded-lg"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.value,(t,l)=>(e.openBlock(),e.createElementBlock("option",{key:l,value:l},e.toDisplayString(t),9,F))),128))],512),[[e.vModelSelect,k.value]]),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=t=>x.value=t),class:"appearance-none bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-800 h-10 px-3 rounded-lg flex-grow"},null,512),[[e.vModelText,x.value]]),e.createVNode(f,{onClick:ke},{default:e.withCtx(()=>[e.createTextVNode(" Run ")]),_:1})])),e.createElementVNode("div",R,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.value,(t,l)=>(e.openBlock(),e.createElementBlock("div",{class:"md:col-span-3 grid gap-3 content-start",key:l},[e.createElementVNode("div",U,e.toDisplayString(t||"Unnamed group"),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.value,(s,fe)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[s.group==t?(e.openBlock(),e.createBlock(f,{key:0,loading:!g.value&&c.value,theme:s.type,onClick:be=>E(s)},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(s.label),1)]),_:2},1032,["loading","theme","onClick"])):e.createCommentVNode("",!0)],64))),256))]))),128))]),e.createElementVNode("div",H,[q,e.createElementVNode("div",z,[e.createVNode(u,{onClick:e.withModifiers(N,["prevent"]),loading:d.value,type:"refresh",title:"Refresh"},null,8,["loading"]),e.createVNode(u,{onClick:r[2]||(r[2]=e.withModifiers(t=>a.value=!a.value,["prevent"])),class:e.normalizeClass([{"text-green-500":a.value,"text-gray-500":!a.value},"w-8 h-8"]),type:"clock",title:"Polling"},null,8,["class"]),e.createVNode(u,{onClick:e.withModifiers(ye,["prevent"]),type:"trash",class:"text-red-500",title:"Clear history"})])]),e.createElementVNode("div",I,[m.value&&Object.keys(m.value).length>0?(e.openBlock(),e.createElementBlock("table",A,[P,e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.value,(t,l)=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",X,e.toDisplayString(t.run),1),e.createElementVNode("td",J,e.toDisplayString(t.type),1),e.createElementVNode("td",K,e.toDisplayString(t.run_by),1),e.createElementVNode("td",{class:e.normalizeClass(["px-2 py-2 border-t border-gray-100 dark:border-gray-700 whitespace-nowrap cursor-pointer dark:bg-gray-800 group-hover:bg-gray-50 dark:group-hover:bg-gray-900",{"!text-green-500":t.status==="success","!text-yellow-500":t.status==="pending","!text-red-500":t.status==="error"}])},e.toDisplayString(t.status),3),e.createElementVNode("td",W,[e.createElementVNode("pre",{innerHTML:t.result},null,8,G)]),e.createElementVNode("td",Q,e.toDisplayString(t.duration?t.duration+" sec.":""),1),e.createElementVNode("td",Y,e.toDisplayString(t.time),1)]))),128))])])):(e.openBlock(),e.createElementBlock("div",Z,[e.createVNode(p,{type:"search",class:"mb-3 text-gray-300 dark:text-gray-500",width:"50",height:"50"}),v]))]),g.value?(e.openBlock(),e.createElementBlock("div",ee,[e.createElementVNode("div",{class:"absolute inset-0",onClick:r[3]||(r[3]=e.withModifiers(()=>g.value=!1,["prevent"]))}),e.createElementVNode("div",te,[e.createElementVNode("div",{class:"absolute top-0 right-0 w-5 cursor-pointer hover:opacity-75 text-lg",onClick:r[4]||(r[4]=e.withModifiers(()=>g.value=!1,["prevent"]))}," ✕ "),e.createElementVNode("div",re,e.toDisplayString(o.value.label),1),e.createElementVNode("div",oe,[o.value.help?(e.openBlock(),e.createElementBlock("p",ae,e.toDisplayString(o.value.help),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value.variables,(t,l)=>(e.openBlock(),e.createElementBlock("div",{key:l},[e.createElementVNode("label",ne,e.toDisplayString(t.label),1),t.field==="select"?e.withDirectives((e.openBlock(),e.createElementBlock("select",{key:0,class:"appearance-none bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-900 h-10 px-3 rounded-lg","onUpdate:modelValue":s=>t.value=s},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.options,s=>(e.openBlock(),e.createElementBlock("option",null,e.toDisplayString(s),1))),256))],8,le)),[[e.vModelSelect,t.value]]):e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:1,type:t.field,class:"w-full appearance-none bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-900 h-10 px-3 rounded-lg","onUpdate:modelValue":s=>t.value=s,placeholder:t.placeholder},null,8,se)),[[e.vModelDynamic,t.value]])]))),128)),o.value.flags.length?(e.openBlock(),e.createElementBlock("div",ce,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value.flags,(t,l)=>(e.openBlock(),e.createElementBlock("label",{key:"flag-"+l,class:"flex items-center cursor-pointer"},[e.withDirectives(e.createElementVNode("input",{type:"checkbox","onUpdate:modelValue":s=>o.value.flags[l].selected=s,"true-value":1,"false-value":0,class:"opacity-0 absolute pointer-events-none"},null,8,de),[[e.vModelCheckbox,o.value.flags[l].selected]]),e.createElementVNode("span",{class:e.normalizeClass(["h-6 w-6 block mr-2 flex-shrink-0 rounded-lg bg-white dark:bg-gray-900 text-transparent border border-gray-300 dark:border-gray-900 flex items-center justify-center text-center",{"!text-gray-900":o.value.flags[l].selected}])}," ✓ ",2),e.createElementVNode("span",null,e.toDisplayString(t.label),1)]))),128))])):e.createCommentVNode("",!0)]),e.createElementVNode("div",ie,[e.createVNode(f,{theme:"gray",onClick:e.withModifiers(V,["prevent"])},{default:e.withCtx(()=>[e.createTextVNode(" Cancel ")]),_:1}),e.createVNode(f,{loading:c.value,onClick:r[5]||(r[5]=t=>he()),theme:o.value.type},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.value.label),1)]),_:1},8,["loading","theme"])])])])):e.createCommentVNode("",!0)])}}};Nova.booting(()=>{Nova.inertia("NovaCommandRunner",pe)})});
